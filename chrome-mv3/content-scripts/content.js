var content=(function(){"use strict";function he(t){return t}const g=globalThis.browser?.runtime?.id?globalThis.browser:globalThis.chrome,S="webhooks",y="webhookFirstAcceptOnly",N=!1,$="a.username",C="a.problem_title.tooltip-click.result-ac",L="status-table",k="a.show-date",M="a.problem_title",U=100,_="problemId",O="level",A="result",P="problemDescription",R="language",V="submissionId",F="username",D="submissionTime",B="runtime",H="memory",j="codeLength",G={0:"Unrated",1:"Bronze V",2:"Bronze IV",3:"Bronze III",4:"Bronze II",5:"Bronze I",6:"Silver V",7:"Silver IV",8:"Silver III",9:"Silver II",10:"Silver I",11:"Gold V",12:"Gold IV",13:"Gold III",14:"Gold II",15:"Gold I",16:"Platinum V",17:"Platinum IV",18:"Platinum III",19:"Platinum II",20:"Platinum I",21:"Diamond V",22:"Diamond IV",23:"Diamond III",24:"Diamond II",25:"Diamond I",26:"Ruby V",27:"Ruby IV",28:"Ruby III",29:"Ruby II",30:"Ruby I",31:"Master"},W=async()=>(await g.storage.sync.get(S))[S]||[],Y=async()=>(await W()).filter(e=>e.active),q=async()=>(await g.storage.sync.get(y))[y]??N;function J(){const t=document.querySelector($);if(!t)return null;const e=t.textContent?.trim();return e||null}function x(){return!!document.querySelector(C)}function z(t){switch(t.toLowerCase()){case"문제번호":case"문제":case"problem":return _;case"난이도":return O;case"결과":case"result":return A;case"문제내용":return P;case"언어":case"language":return R;case"제출 번호":case"solution":return V;case"아이디":case"user":return F;case"제출시간":case"제출한 시간":case"submission time":return D;case"시간":case"time":return B;case"메모리":case"memory":return H;case"코드 길이":case"length":return j;default:return"unknown"}}function K(t){const e={"&amp;":"&","&#38;":"&","&lt;":"<","&#60;":"<","&gt;":">","&#62;":">","&apos;":"'","&#39;":"'","&quot;":'"',"&#34;":'"',"&nbsp;":" ","&#160;":" "};return t.replace(/&(?:amp|#38|lt|#60|gt|#62|apos|#39|quot|#34|nbsp|#160);/g,n=>e[n])}function Q(){const t=document.getElementById(L);if(!t)return null;const e=Array.from(t.rows[0].cells).map(r=>r.innerText.trim()).map(z),n=[];for(let r=1;r<t.rows.length;r++){const s=t.rows[r],c=Array.from(s.cells,(a,u)=>{switch(e[u]){case A:return{result:a.innerText,resultCategory:a.firstChild.getAttribute("data-color").replace("-eng","").trim()};case R:return K(a.innerText).replace(/\/.*$/g,"").trim();case D:const i=a.querySelector(k);return i?i.getAttribute("data-original-title"):null;case _:const d=a.querySelector(M);return d?{problemId:d.getAttribute("href").replace(/^.*\/([0-9]+)$/,"$1")}:null;default:return a.innerText.trim()}});let o={elementId:s.id};for(let a=0;a<e.length;a++)o[e[a]]=c[a];o={...o,...o.result,...o.problemId},n.push(o)}return n}function X(t){const e={"1월":"January","2월":"February","3월":"March","4월":"April","5월":"May","6월":"June","7월":"July","8월":"August","9월":"September","10월":"October","11월":"November","12월":"December"};for(let o in e)t.includes(o)&&(t=t.replace(o,e[o]));t=t.replace("년",", ").replace("일",",").replace(":",":");const n=new Date(Date.parse(t)),s=new Date().getTime()-n.getTime();return Math.floor(s/1e3)}async function Z(t){return await g.runtime.sendMessage({sender:"boj",task:"solvedProblemFetch",problemId:t})}function ee(t){const{level:e,isLevelLocked:n}=t;return e===0&&n?"Not Ratable":G[e]}const te=t=>{switch(t){case"bronze":return 13467442;case"silver":return 12632256;case"gold":return 16766720;case"platinum":return 6421150;case"diamond":return 5093626;case"ruby":return 16716381;default:return 0}};function ne(t){const e=t.split(" ")[0],n="https://cdn.jsdelivr.net/gh/5tarlight/vlog-image@main/bjcord/solved-tier";if(e=="Unrated")return`${n}/unrated.png`;if(t=="Not Ratable")return`${n}/not-ratable.png`;const r=t.split(" ")[1];let s=0;switch(r){case"I":s=1;break;case"II":s=2;break;case"III":s=3;break;case"IV":s=4;break;case"V":s=5;break;default:s=0}return`${n}/${e.toLowerCase()}${s}.png`}async function re(t,e){const n=await fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!n.ok)throw new Error("Failed to send webhook: "+n.statusText)}async function se(t,e,n,r,s,c,o,a,u,i,d){const l=await Z(n);console.log(l);const p=m=>{const E=m.key,w=m.displayNames.filter(ge=>ge.language=="ko");return w?w[0].name:E},f=ee(l);return m=>({content:null,embeds:[{title:`[${f}] ${n}번: ${l.titleKo}`,url:`https://www.acmicpc.net/problem/${n}`,description:`[코드 보기](https://www.acmicpc.net/source/${e})
${l.tags.length>0?`태그: ||${l.tags.map(p).join(", ")}||`:""}`,color:te(f.split(" ")[0].toLowerCase()),fields:[{name:"성능",value:`${s} KB / ${o} ms`,inline:!0},{name:"언어",value:r||"?",inline:!0},{name:"시도한 횟수",value:`${d} 회`,inline:!0},{name:"제출 일자",value:`${i}`,inline:!0},{name:"코드 길이",value:a?`${a} B`:"?",inline:!0},{name:"평균 시도",value:`${l.averageTries} 회`,inline:!0},{name:"맞은 사람",value:`${l.acceptedUserCount} 명`,inline:!0}],author:{name:`${m||t}`,url:`https://solved.ac/profile/${t}`},thumbnail:{url:ne(f)}}],username:"BJCORD",avatar_url:"https://cdn.jsdelivr.net/gh/5tarlight/vlog-image@main/bjcord/thumbnail.png",attachments:[]})}async function oe(t,e){if(x()&&await q()){e.log("Already accepted, aborted.");return}e.log("Watching judgement change...");let n=!1,r=0;const s=t.setInterval(()=>{const c=Q();if(!c||c.length==0)return;const o=c[0];if(o.resultCategory==="judging"||o.resultCategory==="wait"||o.resultCategory==="compile"){n||(n=!0,r=Date.now(),e.log("Waiting for judgement..."));return}if(o.resultCategory!=="ac"){e.log("Latest submission is not AC, aborted."),clearInterval(s);return}if(X(o.submissionTime)>10){if(!n)return;const i=(Date.now()-r)/1e3;e.log(`AC! Took ${i} seconds.`)}clearInterval(s);let u=1;for(let i=1;i<c.length&&c[i].resultCategory!="ac";i++)u++;e.log(`Attempts: ${u}`),e.log("Sending webhook..."),(async()=>{const i=await se(o.username,o.submissionId,o.problemId,o.language,o.memory,o.result,o.runtime,o.codeLength,o.resultCategory,o.submissionTime,u),d=await Y();let l=0,p=0;for(const E of d)try{await re(i(E.displayName),E.url),l++}catch(w){e.error(w),p++}e.log(`Webhook sent! (Success: ${l}, Failed: ${p})`);const m=new Date().getTime()-r;e.log(`Elapsed time: ${m} ms`)})()},U)}const ae=(t,...e)=>{console.log(`[BJCORD][${t}]`,...e)},ie=(t,...e)=>{console.error(`[BJCORD][${t}]`,...e)},ce=t=>({log:(...e)=>ae(t,...e),error:(...e)=>ie(t,...e)}),le={matches:["*://www.acmicpc.net/*","*://acmicpc.net/*"],async main(t){const e=ce("content"),n=location.href;e.log("URL:",n);const r=J();if(!r){e.log("No handle found, aborted.");return}e.log("Handle:",r),["status",`user_id=${r}`,"problem_id","from_mine=1"].every(s=>n.includes(s))?(e.log("Starting..."),await oe(t,e)):e.log("Not in the status page, aborted.")}};function h(t,...e){}const ue={debug:(...t)=>h(console.debug,...t),log:(...t)=>h(console.log,...t),warn:(...t)=>h(console.warn,...t),error:(...t)=>h(console.error,...t)};class v extends Event{constructor(e,n){super(v.EVENT_NAME,{}),this.newUrl=e,this.oldUrl=n}static EVENT_NAME=T("wxt:locationchange")}function T(t){return`${g?.runtime?.id}:content:${t}`}function de(t){let e,n;return{run(){e==null&&(n=new URL(location.href),e=t.setInterval(()=>{let r=new URL(location.href);r.href!==n.href&&(window.dispatchEvent(new v(r,n)),n=r)},1e3))}}}class I{constructor(e,n){this.contentScriptName=e,this.options=n,this.abortController=new AbortController,this.isTopFrame?(this.listenForNewerScripts({ignoreFirstEvent:!0}),this.stopOldScripts()):this.listenForNewerScripts()}static SCRIPT_STARTED_MESSAGE_TYPE=T("wxt:content-script-started");isTopFrame=window.self===window.top;abortController;locationWatcher=de(this);receivedMessageIds=new Set;get signal(){return this.abortController.signal}abort(e){return this.abortController.abort(e)}get isInvalid(){return g.runtime.id==null&&this.notifyInvalidated(),this.signal.aborted}get isValid(){return!this.isInvalid}onInvalidated(e){return this.signal.addEventListener("abort",e),()=>this.signal.removeEventListener("abort",e)}block(){return new Promise(()=>{})}setInterval(e,n){const r=setInterval(()=>{this.isValid&&e()},n);return this.onInvalidated(()=>clearInterval(r)),r}setTimeout(e,n){const r=setTimeout(()=>{this.isValid&&e()},n);return this.onInvalidated(()=>clearTimeout(r)),r}requestAnimationFrame(e){const n=requestAnimationFrame((...r)=>{this.isValid&&e(...r)});return this.onInvalidated(()=>cancelAnimationFrame(n)),n}requestIdleCallback(e,n){const r=requestIdleCallback((...s)=>{this.signal.aborted||e(...s)},n);return this.onInvalidated(()=>cancelIdleCallback(r)),r}addEventListener(e,n,r,s){n==="wxt:locationchange"&&this.isValid&&this.locationWatcher.run(),e.addEventListener?.(n.startsWith("wxt:")?T(n):n,r,{...s,signal:this.signal})}notifyInvalidated(){this.abort("Content script context invalidated"),ue.debug(`Content script "${this.contentScriptName}" context invalidated`)}stopOldScripts(){window.postMessage({type:I.SCRIPT_STARTED_MESSAGE_TYPE,contentScriptName:this.contentScriptName,messageId:Math.random().toString(36).slice(2)},"*")}verifyScriptStartedEvent(e){const n=e.data?.type===I.SCRIPT_STARTED_MESSAGE_TYPE,r=e.data?.contentScriptName===this.contentScriptName,s=!this.receivedMessageIds.has(e.data?.messageId);return n&&r&&s}listenForNewerScripts(e){let n=!0;const r=s=>{if(this.verifyScriptStartedEvent(s)){this.receivedMessageIds.add(s.data.messageId);const c=n;if(n=!1,c&&e?.ignoreFirstEvent)return;this.notifyInvalidated()}};addEventListener("message",r),this.onInvalidated(()=>removeEventListener("message",r))}}function be(){}function b(t,...e){}const me={debug:(...t)=>b(console.debug,...t),log:(...t)=>b(console.log,...t),warn:(...t)=>b(console.warn,...t),error:(...t)=>b(console.error,...t)};return(async()=>{try{const{main:t,...e}=le,n=new I("content",e);return await t(n)}catch(t){throw me.error('The content script "content" crashed on startup!',t),t}})()})();
content;